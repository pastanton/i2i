{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "i2i Configuration",
  "description": "Configuration schema for i2i AI-to-AI communication protocol",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Config schema version"
    },
    "models": {
      "type": "object",
      "description": "Model configurations for different operations",
      "properties": {
        "consensus": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Models used for consensus queries (typically 3)"
        },
        "classifier": {
          "type": "string",
          "description": "Model used for task classification/routing"
        },
        "synthesis": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Models used for synthesizing responses"
        },
        "verification": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Models used for fact verification"
        },
        "epistemic": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Models used for epistemic classification"
        }
      }
    },
    "routing": {
      "type": "object",
      "properties": {
        "default_strategy": {
          "type": "string",
          "enum": ["best_quality", "best_speed", "best_value", "balanced", "ensemble", "fallback_chain"]
        },
        "use_ai_classifier": {
          "type": "boolean",
          "description": "Use AI model for task classification (slower but more accurate)"
        },
        "fallback_enabled": {
          "type": "boolean",
          "description": "Enable fallback to other models on failure"
        }
      }
    },
    "consensus": {
      "type": "object",
      "properties": {
        "min_agreement_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "max_rounds": {
          "type": "integer",
          "minimum": 1
        },
        "require_unanimous": {
          "type": "boolean"
        }
      }
    },
    "statistical_mode": {
      "type": "object",
      "description": "Configuration for statistical consensus mode (n-run averaging)",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable statistical mode by default"
        },
        "n_runs": {
          "type": "integer",
          "minimum": 1,
          "maximum": 20,
          "description": "Number of runs per model"
        },
        "temperature": {
          "type": "number",
          "minimum": 0,
          "maximum": 2,
          "description": "Temperature for queries (>0 required for variance)"
        },
        "outlier_threshold": {
          "type": "number",
          "minimum": 1,
          "description": "Standard deviations for outlier detection"
        },
        "use_embeddings": {
          "type": "boolean",
          "description": "Use embedding-based similarity (vs Jaccard)"
        },
        "embedding_model": {
          "type": "string",
          "description": "OpenAI embedding model to use"
        },
        "parallel_queries": {
          "type": "boolean",
          "description": "Run n queries in parallel"
        }
      }
    },
    "providers": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "enabled": { "type": "boolean" },
          "timeout_ms": { "type": "integer" }
        }
      }
    }
  }
}
